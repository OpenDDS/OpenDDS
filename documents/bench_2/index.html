<!DOCTYPE html>
<html>
<head>
<meta name="generator" content="HTML Tidy for HTML5 for Linux version 5.6.0">
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<style type="text/css">
ul.lst-kix_m1g71dmb4jge-0{list-style-type:none}ul.lst-kix_m1g71dmb4jge-7{list-style-type:none}ul.lst-kix_m1g71dmb4jge-8{list-style-type:none}ul.lst-kix_m1g71dmb4jge-5{list-style-type:none}ul.lst-kix_m1g71dmb4jge-6{list-style-type:none}ul.lst-kix_m1g71dmb4jge-3{list-style-type:none}ul.lst-kix_m1g71dmb4jge-4{list-style-type:none}ul.lst-kix_m1g71dmb4jge-1{list-style-type:none}ul.lst-kix_m1g71dmb4jge-2{list-style-type:none}.lst-kix_dhtlcrrnaf7o-3>li:before{content:"\0025cf  "}.lst-kix_dhtlcrrnaf7o-4>li:before{content:"\0025cb  "}.lst-kix_dhtlcrrnaf7o-1>li:before{content:"\0025cb  "}.lst-kix_dhtlcrrnaf7o-2>li:before{content:"\0025a0  "}.lst-kix_dhtlcrrnaf7o-5>li:before{content:"\0025a0  "}.lst-kix_dhtlcrrnaf7o-6>li:before{content:"\0025cf  "}.lst-kix_dhtlcrrnaf7o-0>li:before{content:"\0025cf  "}.lst-kix_sp2lybtsmun5-2>li:before{content:"\0025a0  "}.lst-kix_sp2lybtsmun5-3>li:before{content:"\0025cf  "}.lst-kix_m1g71dmb4jge-0>li:before{content:"\0025cf  "}ul.lst-kix_bj41ndikikbc-3{list-style-type:none}.lst-kix_sp2lybtsmun5-4>li:before{content:"\0025cb  "}ul.lst-kix_bj41ndikikbc-4{list-style-type:none}.lst-kix_m1g71dmb4jge-1>li:before{content:"\0025cb  "}ul.lst-kix_bj41ndikikbc-1{list-style-type:none}ul.lst-kix_bj41ndikikbc-2{list-style-type:none}.lst-kix_m1g71dmb4jge-2>li:before{content:"\0025a0  "}ul.lst-kix_bj41ndikikbc-7{list-style-type:none}ul.lst-kix_bj41ndikikbc-8{list-style-type:none}ul.lst-kix_bj41ndikikbc-5{list-style-type:none}.lst-kix_sp2lybtsmun5-1>li:before{content:"\0025cb  "}.lst-kix_sp2lybtsmun5-5>li:before{content:"\0025a0  "}ul.lst-kix_bj41ndikikbc-6{list-style-type:none}.lst-kix_m1g71dmb4jge-4>li:before{content:"\0025cb  "}.lst-kix_sp2lybtsmun5-0>li:before{content:"\0025cf  "}.lst-kix_sp2lybtsmun5-8>li:before{content:"\0025a0  "}ul.lst-kix_sp2lybtsmun5-0{list-style-type:none}.lst-kix_m1g71dmb4jge-3>li:before{content:"\0025cf  "}.lst-kix_m1g71dmb4jge-5>li:before{content:"\0025a0  "}ul.lst-kix_sp2lybtsmun5-1{list-style-type:none}ul.lst-kix_sp2lybtsmun5-2{list-style-type:none}.lst-kix_sp2lybtsmun5-6>li:before{content:"\0025cf  "}.lst-kix_sp2lybtsmun5-7>li:before{content:"\0025cb  "}.lst-kix_m1g71dmb4jge-8>li:before{content:"\0025a0  "}ul.lst-kix_sp2lybtsmun5-7{list-style-type:none}ul.lst-kix_sp2lybtsmun5-8{list-style-type:none}.lst-kix_m1g71dmb4jge-7>li:before{content:"\0025cb  "}.lst-kix_bj41ndikikbc-6>li:before{content:"\0025cf  "}.lst-kix_bj41ndikikbc-8>li:before{content:"\0025a0  "}.lst-kix_m1g71dmb4jge-6>li:before{content:"\0025cf  "}ul.lst-kix_sp2lybtsmun5-3{list-style-type:none}ul.lst-kix_sp2lybtsmun5-4{list-style-type:none}ul.lst-kix_sp2lybtsmun5-5{list-style-type:none}.lst-kix_bj41ndikikbc-5>li:before{content:"\0025a0  "}ul.lst-kix_sp2lybtsmun5-6{list-style-type:none}.lst-kix_dhtlcrrnaf7o-7>li:before{content:"\0025cb  "}.lst-kix_dhtlcrrnaf7o-8>li:before{content:"\0025a0  "}.lst-kix_bj41ndikikbc-7>li:before{content:"\0025cb  "}ul.lst-kix_dhtlcrrnaf7o-6{list-style-type:none}ul.lst-kix_dhtlcrrnaf7o-5{list-style-type:none}ul.lst-kix_dhtlcrrnaf7o-8{list-style-type:none}ul.lst-kix_dhtlcrrnaf7o-7{list-style-type:none}.lst-kix_bj41ndikikbc-0>li:before{content:"\0025cf  "}.lst-kix_bj41ndikikbc-1>li:before{content:"\0025cb  "}ul.lst-kix_dhtlcrrnaf7o-0{list-style-type:none}.lst-kix_bj41ndikikbc-2>li:before{content:"\0025a0  "}.lst-kix_bj41ndikikbc-4>li:before{content:"\0025cb  "}ul.lst-kix_dhtlcrrnaf7o-2{list-style-type:none}ul.lst-kix_dhtlcrrnaf7o-1{list-style-type:none}ul.lst-kix_dhtlcrrnaf7o-4{list-style-type:none}ul.lst-kix_dhtlcrrnaf7o-3{list-style-type:none}.lst-kix_bj41ndikikbc-3>li:before{content:"\0025cf  "}ul.lst-kix_bj41ndikikbc-0{list-style-type:none}ol{margin:0;padding:0}table td,table th{padding:0}.c1{margin-left:36pt;padding-top:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c15{padding-top:16pt;padding-bottom:4pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c14{color:#434343;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:"Arial";font-style:normal}.c3{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c23{padding-top:20pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c21{padding-top:0pt;padding-bottom:3pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:center}.c0{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Courier New";font-style:normal}.c17{padding-top:18pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c10{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:"Arial";font-style:normal}.c12{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-family:"Arial";font-style:normal}.c5{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c7{padding-top:0pt;padding-bottom:0pt;line-height:1.0;orphans:2;widows:2;text-align:left}.c22{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c8{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c2{font-weight:400;font-family:"Courier New"}.c11{background-color:#ffffff;color:#3c4043}.c20{width:33%;height:1px}.c18{padding:0;margin:0}.c19{margin-left:180pt;text-indent:-180pt}.c24{color:inherit;text-decoration:inherit}.c13{font-size:20pt}.c9{height:11pt}.c25{font-size:26pt}.c16{font-size:16pt}.c4{font-style:italic}.c6{font-size:10pt}.c26{color:#3c4043}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}
</style>
<title></title>
</head>
<body>
<div class="c8">
<p class="c21 title" id="h.t37m2z552vxs"><span class="c12 c25">OpenDDS: Bench 2</span></p>
<p class="c21 title" id="h.4mgp3rek6p5o"><span class="c12 c25">Performance & Scalability Test Framework</span></p>
<h1 class="c23" id="h.d0a6wr70uvmu"><span class="c12 c13">Motivation</span></h1>
<p class="c5"><span>The Bench 2 framework grew out of a desire to be able to test the performance and scalability of
OpenDDS in large and heterogeneous deployments, along with the ability to quickly develop and deploy new test scenarios
across</span> <span>a</span><span class="c3">&nbsp;potentially-unspecified number of machines.</span></p>
<h1 class="c23" id="h.sta2fcl1sxks"><span class="c12 c13">Overview</span></h1>
<p class="c5"><span class="c3">The resulting design of the Bench 2 framework depends on three primary test
applications: worker processes, one or more node controllers, and a test controller.</span></p>
<p class="c5 c9"></p>
<p class="c5"><span style=
"overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 321.63px;">
<img alt="" src="images/image1.png" style=
"width: 624.00px; height: 321.63px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
title=""></span></p>
<h2 class="c17" id="h.y8jsfykmy1fl"><span class="c12 c16">Worker</span></h2>
<p class="c5"><span>The</span> <span class="c4">worker</span><span>&nbsp;application, true to its name, performs most
of the work associated with any given test scenario. It creaties and exercises the DDS entities specified in its
configuration file and gathers performance statistics related to discovery, data integrity, and performance. The
worker’s configuration file contains regions that may be used to represent OpenDDS’s configuration sections as well as
individual DDS entities and the QoS policies to be for their creation. In addition, the worker configuration contains
test timing values and descriptions of test</span> <span class="c4">actions</span><span class="c3">&nbsp;to be taken
(e.g. publishing and forwarding data read from subscriptions). Upon test completion, the worker can write out a report
file containing the performance statistics gathered during its run.</span></p>
<h2 class="c17" id="h.2mfetxwble62"><span class="c12 c16">Node Controller</span></h2>
<p class="c5"><span>Each machine in the test environment will run (at least) one</span> <span class=
"c4">node_controller</span><span>&nbsp;application which acts as a daemon and, upon request from a</span> <span class=
"c4">test_controller</span><span>, will spawn one or more worker processes. Each request will contain the configuration
to use for the spawned workers and, upon successful exit, the workers’ report files will be read and sent back to
the</span> <span class="c4">test_controller</span><span>&nbsp;which requested it. Failed workers processes (aborts,
crashes) will be noted and have their output logs sent back to the requesting</span> <span class=
"c4">test_controller</span><span class="c3">. In addition to collecting worker reports, the node controller also
gathers general system resource statistics during test execution (CPU and memory utilization) to be returned to the
test controller at the end of the test.</span></p>
<h2 class="c17" id="h.f6wem616bq91"><span class="c12 c16">Test Controller</span></h2>
<p class="c5"><span>Each execution of the test framework will use a</span> <span class=
"c4">test_controller</span><span>&nbsp;to read in a scenario configuration file (an annotated collection of worker
configuration file names) before listening for available</span> <span class="c4">node_controllers</span><span>&nbsp;and
parceling out the scenario’s worker configurations to the individual</span> <span class=
"c4">node_controllers</span><span>. The</span> <span class="c4">test_controller</span><span class="c3">&nbsp;may also
optionally adjust certain worker configuration values for the sake of the test (assigning a unique DDS partition to
avoid collisions, coordinating worker test times, etc). After sending the allocated scenario to each of the available
node controllers, the test controller waits to receive reports from each of the node controllers. After receiving all
the reports, the test_controller coalesces the performance statistics from each of the workers and presents the final
results to the user (both on screen & in a results file).</span></p>
<h1 class="c23" id="h.2te0okee7hhp"><span class="c12 c13">Building Bench 2</span></h1>
<h2 class="c17" id="h.ajbnvdqy3e3l"><span class="c12 c16">Required Features</span></h2>
<p class="c5"><span class="c3">The primary requirements for building OpenDDS such that Bench 2 also gets
built:</span></p>
<ul class="c18 lst-kix_bj41ndikikbc-0 start">
<li class="c1"><span class="c3">C++11 Support (--std=c++11)</span></li>
<li class="c1"><span class="c3">RapidJSON present and enabled (--rapidjson)</span></li>
<li class="c1"><span class="c3">Tests are being built (--tests)</span></li>
</ul>
<h2 class="c17" id="h.j6f0vrso9j9i"><span class="c12 c16">Required Targets</span></h2>
<p class="c5"><span class="c3">If these elements are present, you can either build the entire test suite (slow) or use
these 3 targets (faster), which also cover all the required libraries:</span></p>
<ul class="c18 lst-kix_dhtlcrrnaf7o-0 start">
<li class="c1"><span class="c3">Bench_Worker</span></li>
<li class="c1"><span class="c3">node_controller</span></li>
<li class="c1"><span class="c3">test_controller</span></li>
</ul>
<h1 class="c23" id="h.82y5xo2vvgfp"><span class="c12 c13">Running Bench 2</span></h1>
<h2 class="c17" id="h.4nvf8mwhrns5"><span class="c12 c16">Environment Variables</span></h2>
<p class="c5"><span class="c3">To run Bench 2 executables with dynamically linked or shared libraries, you’ll want to
make sure the Bench 2 libraries are in your library path.</span></p>
<h3 class="c15" id="h.681hn9jkh28o"><span class="c14">Linux/Unix</span></h3>
<p class="c5"><span>Add</span> <span class="c2">${DDS_ROOT}/performance_tests/bench_2/lib</span><span>&nbsp;to
your</span> <span class="c0">LD_LIBRARY_PATH</span></p>
<h3 class="c15" id="h.bxu9e764lx88"><span class="c14">Windows</span></h3>
<p class="c5"><span>Add</span> <span class="c2">%DDS_ROOT%\performance_tests\bench_2\lib</span><span>&nbsp;to
your</span> <span class="c0">PATH</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c3">Assuming DDS_ROOT is already set on your system (from the configure script or from
sourcing setenv.sh), there are convenience scripts to do this for you in the bench_2 directory
(set_bench_env[.sh/.cmd])</span></p>
<h2 class="c17" id="h.2768isuuqon7"><span class="c12 c16">Running a Bench 2 CI Test</span></h2>
<p class="c5"><span class="c3">In the event that you’re debugging a failing Bench 2 CI test, you can use the run_test
perl script found in the bench_2 directory to execute the full scenario without first setting the environment as listed
above, as the perl script sets it automatically before launching a single node_controller in the background and
executing the test controller with the requested scenario. The perl script can be inspected in order to determine which
scenarios have been made available in this way, and the script can be modified to easily run other scenarios against a
single node controller with relative ease.</span></p>
<h2 class="c17" id="h.sglszwo7ku6k"><span class="c12 c16">Running Scenarios Manually</span></h2>
<p class="c5"><span class="c3">Assuming you already have scenario and worker configuration files defined, the general
approach to running a scenario is to start one or more node_controllers (across one or more hosts) and then execute the
test_controller with the desired scenario configuration.</span></p>
<h1 class="c23" id="h.y2g8dzha1jhg"><span class="c12 c13">Configuration Files</span></h1>
<p class="c5"><span>As a rule, Bench 2 uses JSON configuration files that directly map onto the C++ Platform Specific
Model (PSM) of the IDL found in bench_2/idl and the IDL used in the</span> <span class="c22"><a class="c24" href=
"https://www.google.com/url?q=https://www.omg.org/spec/DDS/About-DDS/&amp;sa=D&amp;ust=1603911336520000&amp;usg=AOvVaw3PMna7STNlLwz33s_KOlsg">
DDS specification</a></span><span>. This allows the test applications to easily convert between configuration files and
C++ structures useful for the configuration of DDS entities.</span></p>
<h2 class="c17" id="h.ttfteolb2h0n"><span class="c12 c16">Scenario Configuration Files</span></h2>
<p class="c5"><span class="c3">Scenario configuration files are used by the test controller to determine the number and
type (configuration) of worker processes required for a particular test scenario. In addition, the scenario file may
specify certain sets of workers to be run on the same node by placing them together in a node “prototype” (see
below).</span></p>
<h3 class="c15" id="h.vd97ez5bcz8g"><span class="c14">IDL Definition</span></h3>
<p class="c5"><span class="c0">struct WorkerPrototype {</span></p>
<p class="c5"><span class="c0">&nbsp; // Filename of the JSON Serialized Bench::WorkerConfig</span></p>
<p class="c5"><span class="c0">&nbsp; string config;</span></p>
<p class="c5"><span class="c0">&nbsp; // Number of workers to spawn using this prototype (Must be &gt;=1)</span></p>
<p class="c5"><span class="c0">&nbsp; unsigned long count;</span></p>
<p class="c5"><span class="c0">};</span></p>
<p class="c5"><span class="c0">typedef sequence&lt;WorkerPrototype&gt; WorkerPrototypes;</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">struct NodePrototype {</span></p>
<p class="c5"><span class="c0">&nbsp; WorkerPrototypes workers;</span></p>
<p class="c5"><span class="c0">&nbsp; // Number of Nodes to spawn using this prototype (Must be &gt;=1)</span></p>
<p class="c5"><span class="c0">&nbsp; unsigned long count;</span></p>
<p class="c5"><span class="c0">&nbsp; // This NodePrototype must have a Node to itself</span></p>
<p class="c5"><span class="c0">&nbsp; boolean exclusive;</span></p>
<p class="c5"><span class="c0">};</span></p>
<p class="c5"><span class="c0">typedef sequence&lt;NodePrototype&gt; NodePrototypes;</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">// This is the root type of the scenario configuration file</span></p>
<p class="c5"><span class="c0">struct ScenarioPrototype {</span></p>
<p class="c5"><span class="c0">&nbsp; string name;</span></p>
<p class="c5"><span class="c0">&nbsp; string desc;</span></p>
<p class="c5"><span class="c0">&nbsp; // Workers that must be deployed in sets</span></p>
<p class="c5"><span class="c0">&nbsp; NodePrototypes nodes;</span></p>
<p class="c5"><span class="c0">&nbsp; // Workers that can be assigned to any node</span></p>
<p class="c5"><span class="c0">&nbsp; WorkerPrototypes any_node;</span></p>
<p class="c5"><span class="c0">&nbsp; /*</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp;* Number of seconds to wait for the scenario to end.</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp;* 0 means never timeout.</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp;*/</span></p>
<p class="c5"><span class="c0">&nbsp; unsigned long timeout;</span></p>
<p class="c5"><span class="c0">};</span></p>
<h3 class="c15" id="h.1uedn5cmz5kd"><span class="c14">Annotated Example</span></h3>
<p class="c5"><span class="c0">{</span></p>
<p class="c5"><span class="c0">&nbsp; "name": "An Example",</span></p>
<p class="c5"><span class="c0">&nbsp; "desc": "This shows the structure of the scenario configuration",</span></p>
<p class="c5"><span class="c0">&nbsp; "nodes": [</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; {</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; "workers": [</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "config": "daemon.json",</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "count": 1</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; },</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "config": "spawn.json",</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "count": 1</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; ],</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; "count": 2,</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; "exclusive": false</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; }</span></p>
<p class="c5"><span class="c0">&nbsp; ],</span></p>
<p class="c5"><span class="c0">&nbsp; "any_node": [</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; {</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; "config": "master.json",</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; "count": 1</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; }</span></p>
<p class="c5"><span class="c0">&nbsp; ],</span></p>
<p class="c5"><span class="c0">&nbsp; "timeout": 120</span></p>
<p class="c5"><span class="c0">}</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c3">This scenario configuration will launch 5 worker processes. It will launch 2 pairs of
“daemon” / “spawn” processes, with each member of each pair being kept together on the same node (i.e. same
node_controller). The pairs themselves may be split across nodes, but each “daemon” will be with at least one “spawn”
and vice-versa. They may also wind up all together on the same node, depending on the number of available nodes. And
finally, one “master” process will be started wherever there is room available.</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c3">If node “prototypes” are marked exclusive, the test controller will attempt to allocate
them exclusively to their own node controller. If not enough node controllers exist to honor all the exclusive nodes,
the test controller will fail with an error message.</span></p>
<h2 class="c17" id="h.2phvkdq5hrcc"><span class="c12 c16">Worker Configuration Files</span></h2>
<h3 class="c15" id="h.f6mw9qroi608"><span class="c14">QoS Masking</span></h3>
<p class="c5"><span>In a typical DDS application, default QoS objects are often supplied by the entity factory so that
the application developer can make required changes locally and not impact larger system configuration choices. As
such, the QoS objects found within the JSON configuration file should be treated as a “delta” from the default
configuration object of a parent factory class. So while the JSON “qos” element names will directly match the relevant
IDL element names, there will also be an additional “qos_mask” element that lives alongside the “qos” element in order
to specify which elements apply. For each QoS attribute “</span><span class="c4">attribute</span><span>” within the
“qos” object, there will also be a boolean “</span><span class="c4">has_attribute</span><span class="c3">” within the
“qos_mask” which informs the builder library that this attribute should indeed be applied against the default QoS
object supplied by the parent factory class before the entity is created.</span></p>
<h3 class="c15" id="h.egmg05x3kd5b"><span class="c14">IDL Definition</span></h3>
<p class="c5"><span class="c0">struct TimeStamp {</span></p>
<p class="c5"><span class="c0">&nbsp; long sec;</span></p>
<p class="c5"><span class="c0">&nbsp; unsigned long nsec;</span></p>
<p class="c5"><span class="c0">};</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">typedef sequence&lt;string&gt; StringSeq;</span></p>
<p class="c5"><span class="c0">typedef sequence&lt;double&gt; DoubleSeq;</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">enum PropertyValueKind { PVK_TIME, PVK_STRING, PVK_DOUBLE, PVK_DOUBLE_SEQ, PVK_ULL
};</span></p>
<p class="c5"><span class="c0">union PropertyValue switch (PropertyValueKind) {</span></p>
<p class="c5"><span class="c0">&nbsp; case PVK_TIME:</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; TimeStamp time_prop;</span></p>
<p class="c5"><span class="c0">&nbsp; case PVK_STRING:</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; string string_prop;</span></p>
<p class="c5"><span class="c0">&nbsp; case PVK_DOUBLE:</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; double double_prop;</span></p>
<p class="c5"><span class="c0">&nbsp; case PVK_DOUBLE_SEQ:</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp;DoubleSeq double_seq_prop;</span></p>
<p class="c5"><span class="c0">&nbsp; case PVK_ULL:</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; unsigned long long ull_prop;</span></p>
<p class="c5"><span class="c0">};</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">struct Property {</span></p>
<p class="c5"><span class="c0">&nbsp; string name;</span></p>
<p class="c5"><span class="c0">&nbsp; PropertyValue value;</span></p>
<p class="c5"><span class="c0">};</span></p>
<p class="c5"><span class="c0">typedef sequence&lt;Property&gt; PropertySeq;</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">struct ConfigProperty {</span></p>
<p class="c5"><span class="c0">&nbsp; string name;</span></p>
<p class="c5"><span class="c0">&nbsp; string value;</span></p>
<p class="c5"><span class="c0">};</span></p>
<p class="c5"><span class="c0">typedef sequence&lt;ConfigProperty&gt; ConfigPropertySeq;</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">// ConfigSection</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">struct ConfigSection {</span></p>
<p class="c5"><span class="c0">&nbsp; string name;</span></p>
<p class="c5"><span class="c0">&nbsp; ConfigPropertySeq properties;</span></p>
<p class="c5"><span class="c0">};</span></p>
<p class="c5"><span class="c0">typedef sequence&lt;ConfigSection&gt; ConfigSectionSeq;</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">// Writer</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">struct DataWriterConfig {</span></p>
<p class="c5"><span class="c0">&nbsp; string name;</span></p>
<p class="c5"><span class="c0">&nbsp; string topic_name;</span></p>
<p class="c5"><span class="c0">&nbsp; string listener_type_name;</span></p>
<p class="c5"><span class="c0">&nbsp; unsigned long listener_status_mask;</span></p>
<p class="c5"><span class="c0">&nbsp; string transport_config_name;</span></p>
<p class="c5"><span class="c0">&nbsp; DDS::DataWriterQos qos;</span></p>
<p class="c5"><span class="c0">&nbsp; DataWriterQosMask qos_mask;</span></p>
<p class="c5"><span class="c0">};</span></p>
<p class="c5"><span class="c0">typedef sequence&lt;DataWriterConfig&gt; DataWriterConfigSeq;</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">// Reader</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">struct DataReaderConfig {</span></p>
<p class="c5"><span class="c0">&nbsp; string name;</span></p>
<p class="c5"><span class="c0">&nbsp; string topic_name;</span></p>
<p class="c5"><span class="c0">&nbsp; string listener_type_name;</span></p>
<p class="c5"><span class="c0">&nbsp; unsigned long listener_status_mask;</span></p>
<p class="c5"><span class="c0">&nbsp; PropertySeq listener_properties;</span></p>
<p class="c5"><span class="c0">&nbsp; string transport_config_name;</span></p>
<p class="c5"><span class="c2">&nbsp; DDS::</span><span class="c2">DataReaderQos</span><span class=
"c0">&nbsp;qos;</span></p>
<p class="c5"><span class="c0">&nbsp; DataReaderQosMask qos_mask;</span></p>
<p class="c5"><span class="c0">};</span></p>
<p class="c5"><span class="c0">typedef sequence&lt;DataReaderConfig&gt; DataReaderConfigSeq;</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">// Publisher</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">struct PublisherConfig {</span></p>
<p class="c5"><span class="c0">&nbsp; string name;</span></p>
<p class="c5"><span class="c0">&nbsp; string listener_type_name;</span></p>
<p class="c5"><span class="c0">&nbsp; unsigned long listener_status_mask;</span></p>
<p class="c5"><span class="c0">&nbsp; string transport_config_name;</span></p>
<p class="c5"><span class="c0">&nbsp; DDS::PublisherQos qos;</span></p>
<p class="c5"><span class="c0">&nbsp; PublisherQosMask qos_mask;</span></p>
<p class="c5"><span class="c0">&nbsp; DataWriterConfigSeq datawriters;</span></p>
<p class="c5"><span class="c0">};</span></p>
<p class="c5"><span class="c0">typedef sequence&lt;PublisherConfig&gt; PublisherConfigSeq;</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">// Subscription</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">struct SubscriberConfig {</span></p>
<p class="c5"><span class="c0">&nbsp; string name;</span></p>
<p class="c5"><span class="c0">&nbsp; string listener_type_name;</span></p>
<p class="c5"><span class="c0">&nbsp; unsigned long listener_status_mask;</span></p>
<p class="c5"><span class="c0">&nbsp; string transport_config_name;</span></p>
<p class="c5"><span class="c0">&nbsp; DDS::SubscriberQos qos;</span></p>
<p class="c5"><span class="c0">&nbsp; SubscriberQosMask qos_mask;</span></p>
<p class="c5"><span class="c2">&nbsp;</span> <span class="c2">DataReaderConfigSeq</span><span class=
"c2">&nbsp;</span><span class="c2">datareaders</span><span class="c0">;</span></p>
<p class="c5"><span class="c0">};</span></p>
<p class="c5"><span class="c0">typedef sequence&lt;SubscriberConfig&gt; SubscriberConfigSeq;</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">// Topic</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">struct TopicConfig {</span></p>
<p class="c5"><span class="c0">&nbsp; string name;</span></p>
<p class="c5"><span class="c0">&nbsp; string type_name;</span></p>
<p class="c5"><span class="c0">&nbsp; DDS::TopicQos qos;</span></p>
<p class="c5"><span class="c0">&nbsp; TopicQosMask qos_mask;</span></p>
<p class="c5"><span class="c0">&nbsp; string listener_type_name;</span></p>
<p class="c5"><span class="c0">&nbsp; unsigned long listener_status_mask;</span></p>
<p class="c5"><span class="c0">&nbsp; string transport_config_name;</span></p>
<p class="c5"><span class="c0">};</span></p>
<p class="c5"><span class="c0">typedef sequence&lt;TopicConfig&gt; TopicConfigSeq;</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">// Participant</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">struct ParticipantConfig {</span></p>
<p class="c5"><span class="c0">&nbsp; string name;</span></p>
<p class="c5"><span class="c0">&nbsp; unsigned short domain;</span></p>
<p class="c5"><span class="c0">&nbsp; DDS::DomainParticipantQos qos;</span></p>
<p class="c5"><span class="c0">&nbsp; DomainParticipantQosMask qos_mask;</span></p>
<p class="c5"><span class="c0">&nbsp; string listener_type_name;</span></p>
<p class="c5"><span class="c0">&nbsp; unsigned long listener_status_mask;</span></p>
<p class="c5"><span class="c0">&nbsp; string transport_config_name;</span></p>
<p class="c5"><span class="c0">&nbsp; StringSeq type_names;</span></p>
<p class="c5"><span class="c0">&nbsp; TopicConfigSeq topics;</span></p>
<p class="c5"><span class="c0">&nbsp; PublisherConfigSeq publishers;</span></p>
<p class="c5"><span class="c0">&nbsp; SubscriberConfigSeq subscribers;</span></p>
<p class="c5"><span class="c0">};</span></p>
<p class="c5"><span class="c0">typedef sequence&lt;ParticipantConfig&gt; ParticipantConfigSeq;</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">// TransportInstance</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c2">struct</span><span class="c0">&nbsp;TransportInstanceConfig {</span></p>
<p class="c5"><span class="c0">&nbsp; string name;</span></p>
<p class="c5"><span class="c0">&nbsp; string type;</span></p>
<p class="c5"><span class="c0">&nbsp; unsigned short domain;</span></p>
<p class="c5"><span class="c0">};</span></p>
<p class="c5"><span class="c0">typedef sequence&lt;TransportInstanceConfig&gt; TransportInstanceConfigSeq;</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">// Discovery</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">struct DiscoveryConfig {</span></p>
<p class="c5"><span class="c0">&nbsp; string name;</span></p>
<p class="c5"><span class="c0">&nbsp; string type; // "rtps" or "repo"</span></p>
<p class="c5"><span class="c0">&nbsp; string ior; // "repo" URI (e.g. "file://repo.ior")</span></p>
<p class="c5"><span class="c0">&nbsp; unsigned short domain;</span></p>
<p class="c5"><span class="c0">};</span></p>
<p class="c5"><span class="c0">typedef sequence&lt;DiscoveryConfig&gt; DiscoveryConfigSeq;</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">// Process</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">struct ProcessConfig {</span></p>
<p class="c5"><span class="c0">&nbsp; ConfigSectionSeq config_sections;</span></p>
<p class="c5"><span class="c0">&nbsp; DiscoveryConfigSeq discoveries;</span></p>
<p class="c5"><span class="c0">&nbsp; TransportInstanceConfigSeq instances;</span></p>
<p class="c5"><span class="c0">&nbsp; ParticipantConfigSeq participants;</span></p>
<p class="c5"><span class="c0">};</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">// Worker</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">// This is the root structure of the worker configuration</span></p>
<p class="c5"><span class="c0">// For the sake of readability, module names have been omitted</span></p>
<p class="c5"><span class="c0">// All structures other than this one belong to the Builder module</span></p>
<p class="c5"><span class="c0">struct WorkerConfig {</span></p>
<p class="c5"><span class="c0">&nbsp; TimeStamp create_time;</span></p>
<p class="c5"><span class="c0">&nbsp; TimeStamp enable_time;</span></p>
<p class="c5"><span class="c0">&nbsp; TimeStamp start_time;</span></p>
<p class="c5"><span class="c0">&nbsp; TimeStamp stop_time;</span></p>
<p class="c5"><span class="c0">&nbsp; TimeStamp destruction_time;</span></p>
<p class="c5"><span class="c0">&nbsp; PropertySeq properties;</span></p>
<p class="c5"><span class="c0">&nbsp; ProcessConfig process;</span></p>
<p class="c5"><span class="c0">&nbsp; ActionConfigSeq actions;</span></p>
<p class="c5"><span class="c0">&nbsp; ActionReportSeq action_reports;</span></p>
<p class="c5"><span class="c0">};</span></p>
<h3 class="c15" id="h.w7z2pbpiyp3e"><span class="c14">Annotated Example</span></h3>
<p class="c5"><span class="c0">{</span></p>
<p class="c5"><span class="c2">&nbsp; "create_time": { "sec": -1, "nsec": 0 }</span><sup class="c2"><a href="#ftnt1"
id="ftnt_ref1">[1]</a></sup><span class="c2">,</span></p>
<p class="c5"><span class="c0">&nbsp; "enable_time": { "sec": -1, "nsec": 0 },</span></p>
<p class="c5"><span class="c2">&nbsp; "start_time": { "sec": 0, "nsec": 0 }</span><sup class="c2"><a href="#ftnt2" id=
"ftnt_ref2">[2]</a></sup><span class="c2">,</span></p>
<p class="c5"><span class="c2">&nbsp; "stop_time": { "sec": -10, "nsec": 0 }</span><sup class="c2"><a href="#ftnt3" id=
"ftnt_ref3">[3]</a></sup><span class="c2">,</span></p>
<p class="c5"><span class="c0">&nbsp; "destruction_time": { "sec": -1, "nsec": 0 },</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c2">&nbsp; "process"</span><sup class="c2"><a href="#ftnt4" id=
"ftnt_ref4">[4]</a></sup><span class="c2">: {</span></p>
<p class="c5"><span class="c2">&nbsp; &nbsp; "config_sections"</span><sup class="c2"><a href="#ftnt5" id=
"ftnt_ref5">[5]</a></sup><span class="c2">: [</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; { "name": "common",</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; "properties": [</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; { "name": "DCPSSecurity",</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "value": "0"</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; { "name": "DCPSDebugLevel",</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "value": "0"</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; ]</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; }</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; ],</span></p>
<p class="c5"><span class="c2">&nbsp; &nbsp; "discoveries"</span><sup class="c2"><a href="#ftnt6" id=
"ftnt_ref6">[6]</a></sup><span class="c2">: [</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; { "name": "bench_test_rtps",</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; "type": "rtps",</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; "domain": 7</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; }</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; ],</span></p>
<p class="c5"><span class="c2">&nbsp; &nbsp; "instances"</span><sup class="c2"><a href="#ftnt7" id=
"ftnt_ref7">[7]</a></sup><span class="c2">: [</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; { "name": "rtps_instance_01",</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; "type": "rtps_udp",</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; "domain": 7</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; }</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; ],</span></p>
<p class="c5"><span class="c2">&nbsp; &nbsp; "participants"</span><sup class="c2"><a href="#ftnt8" id=
"ftnt_ref8">[8]</a></sup><span class="c2">: [</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; { "name": "participant_01",</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; "domain": 7,</span></p>
<p class="c5"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; "transport_config_name":
"rtps_instance_01"</span><sup class="c2"><a href="#ftnt9" id="ftnt_ref9">[9]</a></sup><span class="c2">,</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; "qos": { "entity_factory": { "autoenable_created_entities":
false } },</span></p>
<p class="c5"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; "qos_mask": { "entity_factory": {
"has_autoenable_created_entities": false } }</span><sup class="c2"><a href="#ftnt10" id=
"ftnt_ref10">[10]</a></sup><span class="c2">,</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; "topics"</span><sup class="c2"><a href="#ftnt11" id=
"ftnt_ref11">[11]</a></sup><span class="c2">: [</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; { "name": "topic_01",</span></p>
<p class="c5"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "type_name": "Bench::Data"</span><sup class=
"c2"><a href="#ftnt12" id="ftnt_ref12">[12]</a></sup></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; ],</span></p>
<p class="c5"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;"subscribers"</span><sup class="c2"><a href="#ftnt13" id=
"ftnt_ref13">[13]</a></sup><span class="c2">: [</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; { "name": "subscriber_01",</span></p>
<p class="c5"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "datareaders"</span><sup class="c2"><a href=
"#ftnt14" id="ftnt_ref14">[14]</a></sup><span class="c2">: [</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; { "name": "datareader_01",</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "topic_name":
"topic_01",</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "listener_type_name":
"bench_drl",</span></p>
<p class="c5"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "listener_status_mask":
4294967295</span><sup class="c2"><a href="#ftnt15" id="ftnt_ref15">[15]</a></sup><span class="c2">,</span></p>
<p class="c5 c9"></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "qos": { "reliability": {
"kind": "RELIABLE_RELIABILITY_QOS" } },</span></p>
<p class="c5"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "qos_mask": { "reliability": {
"has_kind": true } }</span><sup class="c2"><a href="#ftnt16" id="ftnt_ref16">[16]</a></sup></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ]</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; ],</span></p>
<p class="c5"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; "publishers"</span><sup class="c2"><a href="#ftnt17" id=
"ftnt_ref17">[17]</a></sup><span class="c2">: [</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; { "name": "publisher_01",</span></p>
<p class="c5"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "</span><span class=
"c2">datawriters</span><span class="c2">"</span><sup class="c2"><a href="#ftnt18" id=
"ftnt_ref18">[18]</a></sup><span class="c2">: [</span></p>
<p class="c5"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; { "name": "</span><span class=
"c2">datawriter_01</span><span class="c2">"</span><sup class="c2"><a href="#ftnt19" id=
"ftnt_ref19">[19]</a></sup><span class="c0">,</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "topic_name":
"topic_01",</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "listener_type_name":
"bench_dwl",</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "listener_status_mask":
4294967295</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ]</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; ]</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; }</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; ]</span></p>
<p class="c5"><span class="c0">&nbsp; },</span></p>
<p class="c5"><span class="c2">&nbsp; "actions"</span><sup class="c2"><a href="#ftnt20" id=
"ftnt_ref20">[20]</a></sup><span class="c2">: [</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; {</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; "name": "write_action_01",</span></p>
<p class="c5"><span class="c2">&nbsp; &nbsp; &nbsp; "type": "</span><span class="c2">write</span><span class=
"c2">"</span><sup class="c2"><a href="#ftnt21" id="ftnt_ref21">[21]</a></sup><span class="c0">,</span></p>
<p class="c5"><span class="c2">&nbsp; &nbsp; &nbsp; "writers": [ "</span><span class=
"c2">datawriter_01</span><span class="c2">"</span><sup class="c2"><a href="#ftnt22" id=
"ftnt_ref22">[22]</a></sup><span class="c0">&nbsp;],</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; "params": [</span></p>
<p class="c5"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; { "name": "</span><span class=
"c2">data_buffer_bytes</span><span class="c2">"</span><sup class="c2"><a href="#ftnt23" id=
"ftnt_ref23">[23]</a></sup><span class="c0">,</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "value": { "_d": "PVK_ULL", "ull_prop": 512
}</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; },</span></p>
<p class="c5"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; { "name": "</span><span class=
"c2">write_frequency</span><span class="c2">"</span><sup class="c2"><a href="#ftnt24" id=
"ftnt_ref24">[24]</a></sup><span class="c0">,</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "value": { "_d": "PVK_DOUBLE", "double_prop": 2.0
}</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; &nbsp; ]</span></p>
<p class="c5"><span class="c0">&nbsp; &nbsp; }</span></p>
<p class="c5"><span class="c0">&nbsp; ]</span></p>
<p class="c5"><span class="c2">}</span></p>
<h1 class="c23" id="h.rw781ltjxt1g"><span class="c12 c13">Detailed Application Descriptions</span></h1>
<h2 class="c17" id="h.p1v4c1tndjq0"><span class="c12 c16">test_controller</span></h2>
<p class="c5"><span class="c3">As mentioned above, the test_controller application is the application responsible for
running test scenarios and, as such, will probably wind up being the application most frequently run directly by
testers. The test_controller needs network visibility to at least one node_controller configured to run on the same
domain. It expects, as arguments, the path to a directory containing config files (both scenario & worker) and the name
of a scenario configuration file to run (without the .json extension). For historical reasons, the config directory is
often simply called “example”. The test_controller application also supports a number of optional configuration
parameters, some of which are described in the section below.</span></p>
<h3 class="c15" id="h.wnmzhe3sr91c"><span class="c14">Basic Usage</span></h3>
<p class="c5"><span class="c0">test_controller &lt;config_path&gt; &lt;scenario_name&gt; [&lt;options&gt;]</span></p>
<h3 class="c15" id="h.poxt5b3bj3iz"><span class="c14">Common Options</span></h3>
<p class="c5 c19"><span class="c0">--domain N&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The DDS Domain to use. The
default is 89.</span></p>
<p class="c5 c19"><span class="c0">--wait-for-nodes N&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The number of
seconds to wait for nodes before broadcasting the scenario to them. The default is 10 seconds.</span></p>
<p class="c5 c19"><span class="c0">--timeout N&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The number of seconds to
wait for a scenario to complete. Overrides the value defined in the scenario. If N is 0, there is no
timeout.</span></p>
<p class="c5 c19"><span class="c2">--</span><span class="c2">override</span><span class="c0">-create-time
N&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Overwrite individual worker configs to create their DDS entities N
seconds from now (absolute time reference)</span></p>
<p class="c5 c19"><span class="c2">--override-start-time N&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Overwrite
individual worker configs to start their test actions (writes & forwards) N seconds from now (absolute time
reference)</span></p>
<h2 class="c17" id="h.oprc7zaa4xhy"><span class="c12 c16">node_controller</span></h2>
<p class="c5"><span class="c3">The node controller application is best thought of as a daemon, though the application
can be run both in a long-running “daemon” mode and also a “one-shot” mode more appropriate for testing. The daemon
mode additionally has the ability to exit the process every time an error is encountered, which is useful for
restarting the application when errors are detected, if run as a part of an OS system environment (systemd,
supervisord, etc).</span></p>
<h3 class="c15" id="h.leom1w9gghma"><span class="c14">Basic Usage</span></h3>
<p class="c5"><span class="c0">node_controller &lt;run_mode&gt;</span></p>
<h3 class="c15" id="h.u7yo3y2a5vt0"><span class="c14">Run Mode Options</span></h3>
<p class="c5 c19"><span class="c0">one-shot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Run a single batch of worker
requests (configs &gt; processes &gt; reports) and report the results before exiting. Useful for one-off and local
testing.</span></p>
<p class="c5 c19"><span class="c0">daemon&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Act as a long-running process
that continually runs batches of worker requests, reporting the results. Attempts to recover from errors.</span></p>
<p class="c5 c19"><span class="c0">daemon-exit-on-error&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Act as a
long-running process that continually runs batches of worker requests, reporting the results. Does not attempt to
recover from errors.</span></p>
<h2 class="c17" id="h.hga4semtbfg5"><span class="c12 c16">worker</span></h2>
<p class="c5"><span class="c3">The worker application is meant to mimic the behavior of a single arbitrary OpenDDS test
application. It uses the Bench builder library along with its JSON configuration file to first configure OpenDDS
(including discovery & transports) and then create all required DDS entities using any desired DDS QoS attributes.
Additionally, it allows the user to configure several test phase timing parameters, using either absolute or relative
times:</span></p>
<ul class="c18 lst-kix_m1g71dmb4jge-0 start">
<li class="c1"><span class="c3">DDS entity creation (create_time)</span></li>
<li class="c1"><span class="c3">DDS entity “enabling” (enable_time) (only relevant if autoenable_created_entities QoS
setting is false)</span></li>
<li class="c1"><span class="c3">test actions start time (start_time)</span></li>
<li class="c1"><span class="c3">test actions stop time (stop_time)</span></li>
<li class="c1"><span class="c3">DDS entity destruction (destruction_time)</span></li>
</ul>
<p class="c5 c9"></p>
<p class="c5"><span class="c3">Finally, it also allows for the configuration and execution of test “actions” which take
place between the “start” and “stop” times indicated in configuration. These may make use of the created DDS entities
in order to simulate application behavior. At the time of this writing, the two &nbsp;actions are “write”, which will
write to a datawriter using data of a configurable size and frequency (and maximum count), as well as “forward”, which
will pass along the data read from one datareader to a datawriter, allowing for more complex test behaviors (including
round-trip latency & jitter calculations). In addition to reading a JSON configuration file, the worker is capable of
writing a JSON report file that contains various test statistics gathered from listeners attached to the created DDS
entities. This report is read by the node_controller after the worker process ends and is then sent back to the waiting
test_controller.</span></p>
<h3 class="c15" id="h.uefjp0v01v45"><span class="c14">Basic Usage</span></h3>
<p class="c5"><span class="c0">worker [options] &lt;config_file&gt;</span></p>
<h3 class="c15" id="h.78t7v7tctu9h"><span class="c14">Common Options</span></h3>
<p class="c5 c19"><span class="c0">--log &lt;log_file&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The log file
path.</span></p>
<p class="c5 c19"><span class="c0">--report &lt;report_file&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The
report file path.</span></p>
<p class="c5 c9"></p>
<hr class="c20">
<div>
<p class="c7"><a href="#ftnt_ref1" id="ftnt1">[1]</a><span class="c6">&nbsp;</span><span class="c6 c26">Since the
timestamp is negative, this treats the time as relative and waits one second.</span></p>
</div>
<div>
<p class="c7"><a href="#ftnt_ref2" id="ftnt2">[2]</a><span class="c6">&nbsp;</span><span class="c6 c11">Since the time
is zero and thus neither absolute nor relative, this treats the time as indefinite and waits for keyboard input from
the user.</span></p>
</div>
<div>
<p class="c7"><a href="#ftnt_ref3" id="ftnt3">[3]</a><span class="c6">&nbsp;</span><span class="c11 c6">Again, a
relative timestamp. This time, it waits for 10 seconds for the test actions to run before stopping the test.</span></p>
</div>
<div>
<p class="c7"><a href="#ftnt_ref4" id="ftnt4">[4]</a><span class="c6">&nbsp;</span><span class="c11 c6">This is the
primary section where all the DDS entities are described, along with configuration of OpenDDS.</span></p>
</div>
<div>
<p class="c7"><a href="#ftnt_ref5" id="ftnt5">[5]</a><span class="c12 c6">&nbsp;The elements of this section are
functionally identical to the sections of an OpenDDS .ini file with the same name. Each config section is created
programmatically within the worker process using the name provided and made available to the OpenDDS ServiceParticipant
during entity creation. The example here sets the value of both the DCPSSecurity and DCPSDebugLevel keys to 0 within
the [common] section of the configuration.</span></p>
</div>
<div>
<p class="c7"><a href="#ftnt_ref6" id="ftnt6">[6]</a><span class="c12 c6">&nbsp;Even if there is no configuration
section for it (see above), this allows us to create unique discovery instances per domain. If both are specified, this
will find and use / modify the one specified in the configuration section above. Valid types are "rtps" and "repo"
(requires additional "ior" element with valid URL)</span></p>
</div>
<div>
<p class="c7"><a href="#ftnt_ref7" id="ftnt7">[7]</a><span class="c12 c6">&nbsp;Even if there is no configuration
section for it (see above), this allows us to create unique transport instances. If both are specified, this will find
and use / modify the one specified in the configuration section above. Valid types are "rtps_udp, tcp, udp,
ip_multicast, shmem"</span></p>
</div>
<div>
<p class="c7"><a href="#ftnt_ref8" id="ftnt8">[8]</a><span class="c12 c6">&nbsp;The list of participants to
create.</span></p>
</div>
<div>
<p class="c7"><a href="#ftnt_ref9" id="ftnt9">[9]</a><span class="c12 c6">&nbsp;The transport config that gets bound to
this participant</span></p>
</div>
<div>
<p class="c7"><a href="#ftnt_ref10" id="ftnt10">[10]</a><span class="c12 c6">&nbsp;An example of QoS masking. Note that
in this example, the boolean flag is false, so the QoS mask is not actually applied. In this case, both lines here were
added to make switching back and forth between autoenable_created_entities easier (simply change the value of the
bottom element "has_autoenable_created_entities" to "true")</span></p>
</div>
<div>
<p class="c7"><a href="#ftnt_ref11" id="ftnt11">[11]</a><span class="c12 c6">&nbsp;List of topics to register for this
participant</span></p>
</div>
<div>
<p class="c7"><a href="#ftnt_ref12" id="ftnt12">[12]</a><span class="c12 c6">&nbsp;Note the type name. "Bench::Data" is
currently the only topic data type supported by the Bench 2 framework. That said, it contains a variably sized array of
octets, allowing a configurable range of data payload sizes (see write_action below).</span></p>
</div>
<div>
<p class="c7"><a href="#ftnt_ref13" id="ftnt13">[13]</a><span class="c12 c6">&nbsp;List of subscribers</span></p>
</div>
<div>
<p class="c7"><a href="#ftnt_ref14" id="ftnt14">[14]</a><span class="c12 c6">&nbsp;List of datareaders</span></p>
</div>
<div>
<p class="c7"><a href="#ftnt_ref15" id="ftnt15">[15]</a><span class="c12 c6">&nbsp;Note the listener type and status
mask. "bench_drl" is a listener type registered by the Bench Worker application that does most of the heavy lifting in
terms of stats calculation and reporting. The mask is a fully-enabled bitmask for all listener events (i.e. 2^32 -
1).</span></p>
</div>
<div>
<p class="c7"><a href="#ftnt_ref16" id="ftnt16">[16]</a><span class="c12 c6">&nbsp;Datareaders default to best effort
QoS, so here we are setting the reader to reliable QoS and flagging the qos_mask appropriately in order to get a
reliable datareader.</span></p>
</div>
<div>
<p class="c7"><a href="#ftnt_ref17" id="ftnt17">[17]</a><span class="c12 c6">&nbsp;List of publishers within this
participant</span></p>
</div>
<div>
<p class="c7"><a href="#ftnt_ref18" id="ftnt18">[18]</a><span class="c6">&nbsp;List of</span> <span class=
"c6">datawriters</span><span class="c12 c6">&nbsp;within this publisher</span></p>
</div>
<div>
<p class="c7"><a href="#ftnt_ref19" id="ftnt19">[19]</a><span class="c12 c6">&nbsp;Note that each DDS entity is given a
process-entity-unique name, which can be used below to locate / identify this entity.</span></p>
</div>
<div>
<p class="c7"><a href="#ftnt_ref20" id="ftnt20">[20]</a><span class="c12 c6">&nbsp;A list of worker 'actions' to start
once the test 'start' period begins.</span></p>
</div>
<div>
<p class="c7"><a href="#ftnt_ref21" id="ftnt21">[21]</a><span class="c12 c6">&nbsp;Current valid types are "write" and
"forward"</span></p>
</div>
<div>
<p class="c7"><a href="#ftnt_ref22" id="ftnt22">[22]</a><span class="c6 c12">&nbsp;Note the datawriter name defined
above is passed into the action's writer list. This is used to locate the writer within the process.</span></p>
</div>
<div>
<p class="c7"><a href="#ftnt_ref23" id="ftnt23">[23]</a><span class="c12 c6">&nbsp;The size of the octet array within
the Bench::Data message. Note, actual messages will be slightly larger than this value.</span></p>
</div>
<div>
<p class="c7"><a href="#ftnt_ref24" id="ftnt24">[24]</a><span class="c12 c6">&nbsp;The frequency with which the write
action attempts to write a message. In this case, twice a second.</span></p>
</div>
</div>
</body>
</html>
